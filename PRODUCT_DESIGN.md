# 课堂笔记产品设计文档

## 产品愿景
将录音、拍照、笔记三个独立功能整合成一个完整的产品体验，让大学生在上课时能够轻松记录，课后能够高效复习。

## 核心理念
- **上课时**：极简操作，不影响听课
- **课后**：AI自动整理，结构化呈现
- **复习时**：所有内容互相关联，易于查找

## 用户场景
1. 学生上课时打开App，一键开始录音
2. 看到重要PPT或板书时，快速拍照（自动记录时间点）
3. 听到重点时，快速记录笔记（自动记录时间点）
4. 下课后，AI自动将录音转写成文本，并结合图片和笔记生成结构化的课堂内容
5. 复习时可以通过大纲快速定位，或通过AI助手查询具体内容

## 产品架构

### 1. 上课记录页面（Recording Page）
**设计目标**：将录音、拍照、笔记整合到一个界面，操作简单快捷

**界面布局**：
```
┌─────────────────────────┐
│  🔴 正在录音 00:35:21   │  <- 顶部：录音状态
├─────────────────────────┤
│                         │
│    📸 拍照             │  <- 主操作区：大按钮
│    (已拍 5 张)         │
│                         │
├─────────────────────────┤
│ 📝 随堂笔记：          │  <- 笔记区：快速输入
│ ┌─────────────────────┐│
│ │老师强调了这个公式    ││
│ │很重要，考试必考...   ││
│ └─────────────────────┘│
│    [添加笔记]          │
├─────────────────────────┤
│ 📍 最近记录：          │  <- 底部：最近操作
│ [图] [笔记] 5分钟前    │
└─────────────────────────┘
```

**功能要求**：
- 录音全程运行，不会被其他操作打断
- 拍照后自动返回主界面，显示缩略图
- 笔记输入框始终可见，快速添加
- 所有操作都记录时间戳（基于录音开始时间）

### 2. 课后内容页面（Class Content Page）
**设计目标**：展示AI整理后的结构化内容，方便复习

**界面布局**：
```
┌─────────────────────────┐
│ 📚 高等数学 - 第3章     │  <- 课程信息
│ 2024/1/15 14:00-15:30  │
├─────────────────────────┤
│ 📋 课堂大纲            │  <- AI生成的大纲
│ ├─ 1. 导数的定义       │
│ ├─ 2. 求导法则         │
│ └─ 3. 应用实例         │
├─────────────────────────┤
│ 📄 课堂内容            │  <- 结构化内容
│                        │
│ [导数的定义]           │  <- 章节标题
│ 老师：现在我们来看...   │  <- 转写文本
│ 📸 [PPT图片]           │  <- 相关图片
│ 📝 笔记：考试重点！     │  <- 用户笔记
│                        │
├─────────────────────────┤
│ [查看完整转写文本]      │  <- 查看原始转写
│ [AI助手]               │  <- 智能问答
└─────────────────────────┘
```

**功能要求**：
- 音频文件转写完成后可以删除（节省空间）
- AI根据转写文本、图片OCR、用户笔记生成大纲
- 内容按逻辑章节组织，而非时间顺序
- 保留查看原始转写文本的入口

### 3. 数据模型设计

**录音时的临时数据结构**：
```javascript
{
  classId: "xxx",
  recordingStatus: "active",
  startTime: "2024-01-15T14:00:00",
  
  // 录音文件
  recording: {
    url: "temp/xxx.wav",
    currentTime: 2121 // 秒
  },
  
  // 时间轴事件（按时间戳排序）
  events: [
    {
      type: "image",
      timestamp: 321, // 录音开始后的秒数
      data: {
        url: "images/xxx.jpg",
        thumbnail: "thumbnails/xxx.jpg"
      }
    },
    {
      type: "note",
      timestamp: 495,
      data: {
        content: "考试重点！导数定义要背"
      }
    }
  ]
}
```

**课后处理完成的数据结构**：
```javascript
{
  classId: "xxx",
  title: "高等数学 - 第3章",
  date: "2024-01-15",
  duration: 5400, // 总时长（秒）
  
  // 处理后的内容
  content: {
    // 完整转写文本
    fullTranscript: "完整的课堂录音转写文本...",
    
    // AI生成的结构化内容
    outline: [
      {
        title: "导数的定义",
        summary: "本节介绍了导数的基本概念...",
        transcript: "老师：现在我们来看导数的定义...",
        images: [
          {
            url: "images/xxx.jpg",
            ocrText: "导数定义：lim...",
            description: "导数定义的PPT"
          }
        ],
        notes: [
          {
            content: "考试重点！导数定义要背",
            timestamp: 495 // 保留时间戳用于排序
          }
        ]
      },
      // ... 更多章节
    ],
    
    // 所有原始数据（用于重新处理或导出）
    raw: {
      images: [...],
      notes: [...],
      events: [...] // 保留时间关系
    }
  },
  
  // 处理状态
  processStatus: {
    transcription: "completed",
    aiProcessing: "completed",
    lastProcessed: "2024-01-15T16:00:00"
  }
}
```

## 技术实现计划

### 第一阶段：基础整合（1-2天）
1. **改造录音页面**
   - 将现有的录音功能移到新的整合页面
   - 添加拍照按钮，拍照时记录时间戳
   - 添加笔记输入区域，保存时记录时间戳
   - 实现"最近记录"显示

2. **修改数据模型**
   - 扩展Class模型，支持events数组
   - 修改上传接口，支持时间戳参数
   - 确保向后兼容

### 第二阶段：课后处理（2-3天）
1. **实现AI内容整理**
   - 转写完成后触发AI处理
   - 分析转写文本，识别章节结构
   - 将图片和笔记分配到对应章节
   - 生成章节摘要

2. **优化展示页面**
   - 实现大纲导航
   - 章节化展示内容
   - 支持展开/收起章节

### 第三阶段：体验优化（1-2天）
1. **交互优化**
   - 录音页面的动画和反馈
   - 拍照的快速预览
   - 笔记的自动保存

2. **性能优化**
   - 大文件的分片处理
   - 图片压缩和缩略图
   - 内容的懒加载

## 注意事项

1. **时间戳的必要性**
   - 先实现基础版本，收集用户反馈
   - 如果用户不需要时间关联，可以简化为纯粹的内容整理

2. **音频文件管理**
   - 转写完成后提供删除音频的选项
   - 考虑添加音频压缩功能减少存储

3. **AI处理的边界**
   - AI只做内容组织，不改变原始信息
   - 保留用户手动调整的能力

## 下一步行动

1. 开始实现第一阶段的录音页面改造
2. 先完成基础功能，再逐步优化
3. 每个阶段完成后进行测试和调整

---

更新日志：
- 2024-01-XX：初始版本，定义产品形态和实现计划